<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Relative Mortality Metric (RMM) Calculation — rmm • traumar</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Relative Mortality Metric (RMM) Calculation — rmm"><meta name="description" content="Calculates the Relative Mortality Metric (RMM) from Napoli et al. (2017)
based on patient survival probabilities (Ps) and actual outcomes. The
function groups patients into bins based on their survival probability scores
(Ps) and computes a weighted mortality metric along with confidence
intervals. For more information on the methods used in this function, see as
well Schroeder et al. (2019), and Kassar et al. (2016).
The Relative Mortality Metric (RMM) quantifies the performance of a center in
comparison to the anticipated mortality based on the TRISS national
benchmark. The RMM measures the difference between observed and expected
mortality, with a range from -1 to 1.
An RMM of 0 indicates that the observed mortality aligns with the expected
national benchmark across all acuity levels.
An RMM greater than 0 indicates better-than-expected performance, where
the center is outperforming the national benchmark.
An RMM less than 0 indicates under-performance, where the center’s observed
mortality is higher than the expected benchmark.


This metric helps assess how a center's mortality compares to the national
standards, guiding quality improvement efforts. rmm() utilizes bootstrap
sampling to calculate the confidence intervals via the standard error method."><meta property="og:description" content="Calculates the Relative Mortality Metric (RMM) from Napoli et al. (2017)
based on patient survival probabilities (Ps) and actual outcomes. The
function groups patients into bins based on their survival probability scores
(Ps) and computes a weighted mortality metric along with confidence
intervals. For more information on the methods used in this function, see as
well Schroeder et al. (2019), and Kassar et al. (2016).
The Relative Mortality Metric (RMM) quantifies the performance of a center in
comparison to the anticipated mortality based on the TRISS national
benchmark. The RMM measures the difference between observed and expected
mortality, with a range from -1 to 1.
An RMM of 0 indicates that the observed mortality aligns with the expected
national benchmark across all acuity levels.
An RMM greater than 0 indicates better-than-expected performance, where
the center is outperforming the national benchmark.
An RMM less than 0 indicates under-performance, where the center’s observed
mortality is higher than the expected benchmark.


This metric helps assess how a center's mortality compares to the national
standards, guiding quality improvement efforts. rmm() utilizes bootstrap
sampling to calculate the confidence intervals via the standard error method."><meta property="og:image" content="https://bemts-hhs.github.io/traumar/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">traumar</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.2.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/bemts-hhs/traumar/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Relative Mortality Metric (RMM) Calculation</h1>
      <small class="dont-index">Source: <a href="https://github.com/bemts-hhs/traumar/blob/main/R/relative_mortality.R" class="external-link"><code>R/relative_mortality.R</code></a></small>
      <div class="d-none name"><code>rmm.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Calculates the Relative Mortality Metric (RMM) from Napoli et al. (2017)
based on patient survival probabilities (Ps) and actual outcomes. The
function groups patients into bins based on their survival probability scores
(Ps) and computes a weighted mortality metric along with confidence
intervals. For more information on the methods used in this function, see as
well Schroeder et al. (2019), and Kassar et al. (2016).</p>
<p>The Relative Mortality Metric (RMM) quantifies the performance of a center in
comparison to the anticipated mortality based on the TRISS national
benchmark. The RMM measures the difference between observed and expected
mortality, with a range from -1 to 1.</p><ul><li><p>An RMM of 0 indicates that the observed mortality aligns with the expected
national benchmark across all acuity levels.</p></li>
<li><p>An RMM greater than 0 indicates better-than-expected performance, where
the center is outperforming the national benchmark.</p></li>
<li><p>An RMM less than 0 indicates under-performance, where the center’s observed
mortality is higher than the expected benchmark.</p></li>
</ul><p>This metric helps assess how a center's mortality compares to the national
standards, guiding quality improvement efforts. <code>rmm()</code> utilizes bootstrap
sampling to calculate the confidence intervals via the standard error method.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">rmm</span><span class="op">(</span></span>
<span>  <span class="va">data</span>,</span>
<span>  <span class="va">Ps_col</span>,</span>
<span>  <span class="va">outcome_col</span>,</span>
<span>  group_vars <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  n_samples <span class="op">=</span> <span class="fl">100</span>,</span>
<span>  Divisor1 <span class="op">=</span> <span class="fl">5</span>,</span>
<span>  Divisor2 <span class="op">=</span> <span class="fl">5</span>,</span>
<span>  Threshold_1 <span class="op">=</span> <span class="fl">0.9</span>,</span>
<span>  Threshold_2 <span class="op">=</span> <span class="fl">0.99</span>,</span>
<span>  bootstrap_ci <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  pivot <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  seed <span class="op">=</span> <span class="cn">NULL</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-data">data<a class="anchor" aria-label="anchor" href="#arg-data"></a></dt>
<dd><p>A data frame or tibble containing the data.</p></dd>


<dt id="arg-ps-col">Ps_col<a class="anchor" aria-label="anchor" href="#arg-ps-col"></a></dt>
<dd><p>The name of the column containing the survival probabilities
(Ps). Should be numeric on a scale from 0 to 1.</p></dd>


<dt id="arg-outcome-col">outcome_col<a class="anchor" aria-label="anchor" href="#arg-outcome-col"></a></dt>
<dd><p>The name of the column containing the outcome data. It
should be binary, with values indicating patient survival. A value of <code>1</code>
should represent "alive" (survived), while <code>0</code> should represent "dead" (did
not survive).  <code>TRUE/FALSE</code> are accepted as well. Ensure the column
contains only these possible values.</p></dd>


<dt id="arg-group-vars">group_vars<a class="anchor" aria-label="anchor" href="#arg-group-vars"></a></dt>
<dd><p>Optional character vector specifying grouping variables for
stratified analysis. If <code>NULL</code>, the calculation is performed on the entire
dataset.</p></dd>


<dt id="arg-n-samples">n_samples<a class="anchor" aria-label="anchor" href="#arg-n-samples"></a></dt>
<dd><p>A numeric value indicating the number of bootstrap samples
to take from the data source.</p></dd>


<dt id="arg-divisor-">Divisor1<a class="anchor" aria-label="anchor" href="#arg-divisor-"></a></dt>
<dd><p>A divisor used for binning the survival probabilities
(default is 5).</p></dd>


<dt id="arg-divisor-">Divisor2<a class="anchor" aria-label="anchor" href="#arg-divisor-"></a></dt>
<dd><p>A second divisor used for binning the survival probabilities
(default is 5).</p></dd>


<dt id="arg-threshold-">Threshold_1<a class="anchor" aria-label="anchor" href="#arg-threshold-"></a></dt>
<dd><p>The first threshold for dividing the survival
probabilities (default is 0.9).</p></dd>


<dt id="arg-threshold-">Threshold_2<a class="anchor" aria-label="anchor" href="#arg-threshold-"></a></dt>
<dd><p>The second threshold for dividing the survival
probabilities (default is 0.99).</p></dd>


<dt id="arg-bootstrap-ci">bootstrap_ci<a class="anchor" aria-label="anchor" href="#arg-bootstrap-ci"></a></dt>
<dd><p>A logical indicating whether to return the relative
mortality metric estimate and 95% confidence intervals using bootstrap
sampling. Default is <code>TRUE</code>.</p></dd>


<dt id="arg-pivot">pivot<a class="anchor" aria-label="anchor" href="#arg-pivot"></a></dt>
<dd><p>A logical indicating whether to return the results in a long
format (<code>pivot = TRUE</code>) or wide format (<code>pivot = FALSE</code>, default). Use with
caution in tandem with <code>group_vars</code> if the grouping variable is of a
different class than <code>rmm()</code>'s outputs, such as <code>factor</code> or <code>character</code>
grouping variables.</p></dd>


<dt id="arg-seed">seed<a class="anchor" aria-label="anchor" href="#arg-seed"></a></dt>
<dd><p>Optional numeric value to set a random seed for reproducibility.
If <code>NULL</code> (default), no seed is set.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A tibble containing the Relative Mortality Metric (RMM) and related
statistics:</p><ul><li><p><code>population_RMM_LL</code>: The lower bound of the 95% confidence interval for
the population RMM.</p></li>
<li><p><code>population_RMM</code>: The final calculated Relative Mortality Metric for the
population existing in <code>data</code>.</p></li>
<li><p><code>population_RMM_UL</code>: The upper bound of the 95% confidence interval for
the population RMM.</p></li>
<li><p><code>population_CI</code>: The confidence interval width for the population RMM.</p></li>
<li><p><code>bootstrap_RMM_LL</code>: The lower bound of the 95% confidence interval for
the bootstrap RMM. (optional, if <code>bootstrap_ci = TRUE</code>)</p></li>
<li><p><code>bootstrap_RMM</code>: The average RMM value calculated for the bootstrap
sample. (optional, if <code>bootstrap_ci = TRUE</code>)</p></li>
<li><p><code>bootstrap_RMM_UL</code>: The upper bound of the 95% confidence interval for
the bootstrap RMM. (optional, if <code>bootstrap_ci = TRUE</code>)</p></li>
<li><p><code>bootstrap_CI</code>: The width of the 95% confidence interval for the
bootstrap RMM. (optional, if <code>bootstrap_ci = TRUE</code>)</p></li>
<li><p>If <code>pivot = TRUE</code>, the results will be in long format with two columns:
<code>stat</code> and <code>value</code>, where each row corresponds to one of the calculated
statistics.</p></li>
<li><p>If <code>pivot = FALSE</code> (default), the results will be returned in wide
format, with each statistic as a separate column.</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>Like other statistical computing functions, <code>rmm()</code> is happiest without
missing data.  It is best to pass complete probability of survival and
mortality outcome data to the function for optimal performance. With smaller
datasets, this is especially helpful.  However, <code>rmm()</code> will throw a warning
about missing values, if any exist in <code>Ps_col</code> and/or <code>outcome_col</code>.</p>
<p><code>rmm()</code> assumes <code>Ps_col</code> contains probabilities derived from
real-world inputs for the Trauma Injury Severity Score (TRISS) model.
Synthetic or low-variability data (especially with small sample sizes) may
not reflect the distribution of TRISS-derived survival probabilities. This
can result in unstable estimates or function failure due to insufficient
dispersion. With small sample sizes, it may be important to use smaller
values with the divisor arguments and adjust the thresholds (based on the
distribution of the <code>Ps_col</code> values) to create bins that better accommodate
the data.</p>
<p>Due to the use of bootstrap sampling within the function, users should
consider setting the random number <code>seed</code> within <code>rmm()</code> for reproducibility.</p>
    </div>
    <div class="section level2">
    <h2 id="note">Note<a class="anchor" aria-label="anchor" href="#note"></a></h2>
    <p>This function will produce the most reliable and interpretable results when
using a dataset that has one row per patient, with each column being a
feature.</p>
<p>By default, <code>rmm()</code> derives bin cut points from the full dataset’s
distribution. This ensures comparability across groups when <code>group_vars</code> is
used. To tailor results to a specific group (e.g., a single hospital), filter
the dataset to that subgroup before calling <code>rmm()</code>. The function will then
compute bins and related statistics using only that subset’s <code>Ps_col</code>
distribution. When <code>group_vars</code> is used, and ff a group lacks
observations within one or more bins, <code><a href="rm_bin_summary.html">rm_bin_summary()</a></code> will compute
statistics only for the bins that contain data. Bins with no observations are
excluded from the summary for that group.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Kassar, O.M., Eklund, E.A., Barnhardt, W.F., Napoli, N.J., Barnes, L.E.,
Young, J.S. (2016). Trauma survival margin analysis: A dissection of trauma
center performance through initial lactate. The American Surgeon, 82(7),
649-653. <a href="doi:10.1177/000313481608200733">doi:10.1177/000313481608200733</a></p>
<p>Napoli, N. J., Barnhardt, W., Kotoriy, M. E., Young, J. S., &amp; Barnes, L. E.
(2017). Relative mortality analysis: A new tool to evaluate clinical
performance in trauma centers. IISE Transactions on Healthcare Systems
Engineering, 7(3), 181–191. <a href="doi:10.1080/24725579.2017.1325948">doi:10.1080/24725579.2017.1325948</a></p>
<p>Schroeder, P. H., Napoli, N. J., Barnhardt, W. F., Barnes, L. E., &amp; Young, J.
S. (2018). Relative mortality analysis of the “golden hour”: A comprehensive
acuity stratification approach to address disagreement in current literature.
Prehospital Emergency Care, 23(2), 254–262.
<a href="doi:10.1080/10903127.2018.1489021">doi:10.1080/10903127.2018.1489021</a></p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="probability_of_survival.html">probability_of_survival()</a></code>, <code><a href="rm_bin_summary.html">rm_bin_summary()</a></code>, and
<code><a href="nonlinear_bins.html">nonlinear_bins()</a></code></p></div>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Nicolas Foss, Ed.D, MS, original implementation in MATLAB by Nicholas
J. Napoli, Ph.D., MS</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># Generate example data</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Parameters</span></span></span>
<span class="r-in"><span><span class="co"># Total number of patients</span></span></span>
<span class="r-in"><span><span class="va">n_patients</span> <span class="op">&lt;-</span> <span class="fl">5000</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Arbitrary group labels</span></span></span>
<span class="r-in"><span><span class="va">groups</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">LETTERS</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">]</span>, size <span class="op">=</span> <span class="va">n_patients</span>, replace <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Trauma types</span></span></span>
<span class="r-in"><span><span class="va">trauma_type_values</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Blunt"</span>, <span class="st">"Penetrating"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  size <span class="op">=</span> <span class="va">n_patients</span>,</span></span>
<span class="r-in"><span>  replace <span class="op">=</span> <span class="cn">TRUE</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># RTS values</span></span></span>
<span class="r-in"><span><span class="va">rts_values</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span>from <span class="op">=</span> <span class="fl">0</span>, to <span class="op">=</span> <span class="fl">7.8408</span>, by <span class="op">=</span> <span class="fl">0.005</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  size <span class="op">=</span> <span class="va">n_patients</span>,</span></span>
<span class="r-in"><span>  replace <span class="op">=</span> <span class="cn">TRUE</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># patient ages</span></span></span>
<span class="r-in"><span><span class="va">ages</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span>from <span class="op">=</span> <span class="fl">0</span>, to <span class="op">=</span> <span class="fl">100</span>, by <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  size <span class="op">=</span> <span class="va">n_patients</span>,</span></span>
<span class="r-in"><span>  replace <span class="op">=</span> <span class="cn">TRUE</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># ISS scores</span></span></span>
<span class="r-in"><span><span class="va">iss_scores</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span>from <span class="op">=</span> <span class="fl">0</span>, to <span class="op">=</span> <span class="fl">75</span>, by <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  size <span class="op">=</span> <span class="va">n_patients</span>,</span></span>
<span class="r-in"><span>  replace <span class="op">=</span> <span class="cn">TRUE</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Generate survival probabilities (Ps)</span></span></span>
<span class="r-in"><span><span class="va">Ps</span> <span class="op">&lt;-</span> <span class="fu">traumar</span><span class="fu">::</span><span class="fu"><a href="probability_of_survival.html">probability_of_survival</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  trauma_type <span class="op">=</span> <span class="va">trauma_type_values</span>,</span></span>
<span class="r-in"><span>  age <span class="op">=</span> <span class="va">ages</span>,</span></span>
<span class="r-in"><span>  rts <span class="op">=</span> <span class="va">rts_values</span>,</span></span>
<span class="r-in"><span>  iss <span class="op">=</span> <span class="va">iss_scores</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Simulate survival outcomes based on Ps</span></span></span>
<span class="r-in"><span><span class="va">survival_outcomes</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html" class="external-link">rbinom</a></span><span class="op">(</span><span class="va">n_patients</span>, size <span class="op">=</span> <span class="fl">1</span>, prob <span class="op">=</span> <span class="va">Ps</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Create data frame</span></span></span>
<span class="r-in"><span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>Ps <span class="op">=</span> <span class="va">Ps</span>, survival <span class="op">=</span> <span class="va">survival_outcomes</span>, groups <span class="op">=</span> <span class="va">groups</span><span class="op">)</span> <span class="op">|&gt;</span></span></span>
<span class="r-in"><span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>death <span class="op">=</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/if_else.html" class="external-link">if_else</a></span><span class="op">(</span><span class="va">survival</span> <span class="op">==</span> <span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Example usage of the `rmm` function</span></span></span>
<span class="r-in"><span><span class="fu">rmm</span><span class="op">(</span>data <span class="op">=</span> <span class="va">data</span>, Ps_col <span class="op">=</span> <span class="va">Ps</span>,</span></span>
<span class="r-in"><span>    outcome_col <span class="op">=</span> <span class="va">survival</span>,</span></span>
<span class="r-in"><span>    Divisor1 <span class="op">=</span> <span class="fl">4</span>,</span></span>
<span class="r-in"><span>    Divisor2 <span class="op">=</span> <span class="fl">4</span>,</span></span>
<span class="r-in"><span>    n_samples <span class="op">=</span> <span class="fl">10</span></span></span>
<span class="r-in"><span>    <span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 1 × 8</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   population_RMM_LL population_RMM population_RMM_UL population_CI</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>               <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>          <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>             <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>         <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">1</span>            -<span style="color: #BB0000;">0.106</span>        0.002<span style="text-decoration: underline;">47</span>             0.111         0.108</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># ℹ 4 more variables: bootstrap_RMM_LL &lt;dbl&gt;, bootstrap_RMM &lt;dbl&gt;,</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;">#   bootstrap_RMM_UL &lt;dbl&gt;, bootstrap_CI &lt;dbl&gt;</span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># pivot!</span></span></span>
<span class="r-in"><span><span class="fu">rmm</span><span class="op">(</span>data <span class="op">=</span> <span class="va">data</span>, Ps_col <span class="op">=</span> <span class="va">Ps</span>,</span></span>
<span class="r-in"><span>    outcome_col <span class="op">=</span> <span class="va">survival</span>,</span></span>
<span class="r-in"><span>    Divisor1 <span class="op">=</span> <span class="fl">4</span>,</span></span>
<span class="r-in"><span>    Divisor2 <span class="op">=</span> <span class="fl">4</span>,</span></span>
<span class="r-in"><span>    n_samples <span class="op">=</span> <span class="fl">10</span>,</span></span>
<span class="r-in"><span>    pivot <span class="op">=</span> <span class="cn">TRUE</span></span></span>
<span class="r-in"><span>    <span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 8 × 2</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   stat                 value</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">1</span> population_RMM_LL -<span style="color: #BB0000;">0.106</span>  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">2</span> population_RMM     0.002<span style="text-decoration: underline;">47</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">3</span> population_RMM_UL  0.111  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">4</span> population_CI      0.108  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">5</span> bootstrap_RMM_LL  -<span style="color: #BB0000;">0.014</span><span style="color: #BB0000; text-decoration: underline;">5</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">6</span> bootstrap_RMM     -<span style="color: #BB0000;">0.005</span><span style="color: #BB0000; text-decoration: underline;">44</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">7</span> bootstrap_RMM_UL   0.003<span style="text-decoration: underline;">66</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">8</span> bootstrap_CI       0.009<span style="text-decoration: underline;">10</span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Create example grouping variable (e.g., hospital)</span></span></span>
<span class="r-in"><span><span class="va">hospital</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Hospital A"</span>, <span class="st">"Hospital B"</span><span class="op">)</span>, <span class="va">n_patients</span>, replace <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Create data frame</span></span></span>
<span class="r-in"><span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  Ps <span class="op">=</span> <span class="va">Ps</span>,</span></span>
<span class="r-in"><span>  survival <span class="op">=</span> <span class="va">survival_outcomes</span>,</span></span>
<span class="r-in"><span>  hospital <span class="op">=</span> <span class="va">hospital</span></span></span>
<span class="r-in"><span><span class="op">)</span> <span class="op">|&gt;</span></span></span>
<span class="r-in"><span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>death <span class="op">=</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/if_else.html" class="external-link">if_else</a></span><span class="op">(</span><span class="va">survival</span> <span class="op">==</span> <span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Example usage of the `rmm` function with grouping by hospital</span></span></span>
<span class="r-in"><span><span class="fu">rmm</span><span class="op">(</span></span></span>
<span class="r-in"><span>  data <span class="op">=</span> <span class="va">data</span>,</span></span>
<span class="r-in"><span>  Ps_col <span class="op">=</span> <span class="va">Ps</span>,</span></span>
<span class="r-in"><span>  outcome_col <span class="op">=</span> <span class="va">survival</span>,</span></span>
<span class="r-in"><span>  group_vars <span class="op">=</span> <span class="st">"hospital"</span>,</span></span>
<span class="r-in"><span>  Divisor1 <span class="op">=</span> <span class="fl">4</span>,</span></span>
<span class="r-in"><span>  Divisor2 <span class="op">=</span> <span class="fl">4</span>,</span></span>
<span class="r-in"><span>  n_samples <span class="op">=</span> <span class="fl">10</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 2 × 9</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   hospital   population_RMM_LL population_RMM population_RMM_UL population_CI</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>          <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>             <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>         <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">1</span> Hospital A            -<span style="color: #BB0000;">0.131</span>         0.021<span style="text-decoration: underline;">1</span>             0.173         0.152</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">2</span> Hospital B            -<span style="color: #BB0000;">0.169</span>        -<span style="color: #BB0000;">0.014</span><span style="color: #BB0000; text-decoration: underline;">9</span>             0.139         0.154</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># ℹ 4 more variables: bootstrap_RMM_LL &lt;dbl&gt;, bootstrap_RMM &lt;dbl&gt;,</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;">#   bootstrap_RMM_UL &lt;dbl&gt;, bootstrap_CI &lt;dbl&gt;</span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Pivoted output for easier visualization</span></span></span>
<span class="r-in"><span><span class="fu">rmm</span><span class="op">(</span></span></span>
<span class="r-in"><span>  data <span class="op">=</span> <span class="va">data</span>,</span></span>
<span class="r-in"><span>  Ps_col <span class="op">=</span> <span class="va">Ps</span>,</span></span>
<span class="r-in"><span>  outcome_col <span class="op">=</span> <span class="va">survival</span>,</span></span>
<span class="r-in"><span>  group_vars <span class="op">=</span> <span class="st">"hospital"</span>,</span></span>
<span class="r-in"><span>  Divisor1 <span class="op">=</span> <span class="fl">4</span>,</span></span>
<span class="r-in"><span>  Divisor2 <span class="op">=</span> <span class="fl">4</span>,</span></span>
<span class="r-in"><span>  n_samples <span class="op">=</span> <span class="fl">10</span>,</span></span>
<span class="r-in"><span>  pivot <span class="op">=</span> <span class="cn">TRUE</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 16 × 3</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    hospital   stat                   value</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 1</span> Hospital A population_RMM_LL -<span style="color: #BB0000;">0.131</span>    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 2</span> Hospital A population_RMM     0.021<span style="text-decoration: underline;">1</span>   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 3</span> Hospital A population_RMM_UL  0.173    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 4</span> Hospital A population_CI      0.152    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 5</span> Hospital A bootstrap_RMM_LL   0.007<span style="text-decoration: underline;">84</span>  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 6</span> Hospital A bootstrap_RMM      0.020<span style="text-decoration: underline;">2</span>   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 7</span> Hospital A bootstrap_RMM_UL   0.032<span style="text-decoration: underline;">6</span>   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 8</span> Hospital A bootstrap_CI       0.012<span style="text-decoration: underline;">4</span>   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 9</span> Hospital B population_RMM_LL -<span style="color: #BB0000;">0.169</span>    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">10</span> Hospital B population_RMM    -<span style="color: #BB0000;">0.014</span><span style="color: #BB0000; text-decoration: underline;">9</span>   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">11</span> Hospital B population_RMM_UL  0.139    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">12</span> Hospital B population_CI      0.154    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">13</span> Hospital B bootstrap_RMM_LL  -<span style="color: #BB0000;">0.023</span><span style="color: #BB0000; text-decoration: underline;">1</span>   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">14</span> Hospital B bootstrap_RMM     -<span style="color: #BB0000;">0.011</span><span style="color: #BB0000; text-decoration: underline;">5</span>   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">15</span> Hospital B bootstrap_RMM_UL   0.000<span style="text-decoration: underline;">072</span>5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">16</span> Hospital B bootstrap_CI       0.011<span style="text-decoration: underline;">6</span>   </span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Nicolas Foss.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.2.</p>
</div>

    </footer></div>





  </body></html>

