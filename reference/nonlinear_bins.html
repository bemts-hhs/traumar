<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Create Nonlinear Probability of Survival Bins — nonlinear_bins • traumar</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Create Nonlinear Probability of Survival Bins — nonlinear_bins"><meta name="description" content="This function generates nonlinear bins for probability of survival data based
on specified thresholds and divisors as specified in Napoli et al. (2017),
Schroeder et al. (2019), and Kassar et al. (2016). This function calculates
bin statistics, including mean, standard deviation, total alive, total dead,
count, and percentage for each bin."><meta property="og:description" content="This function generates nonlinear bins for probability of survival data based
on specified thresholds and divisors as specified in Napoli et al. (2017),
Schroeder et al. (2019), and Kassar et al. (2016). This function calculates
bin statistics, including mean, standard deviation, total alive, total dead,
count, and percentage for each bin."><meta property="og:image" content="https://bemts-hhs.github.io/traumar/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">traumar</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.2.2</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/bemts-hhs/traumar/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Create Nonlinear Probability of Survival Bins</h1>
      <small class="dont-index">Source: <a href="https://github.com/bemts-hhs/traumar/blob/main/R/non_linear_bins.R" class="external-link"><code>R/non_linear_bins.R</code></a></small>
      <div class="d-none name"><code>nonlinear_bins.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This function generates nonlinear bins for probability of survival data based
on specified thresholds and divisors as specified in Napoli et al. (2017),
Schroeder et al. (2019), and Kassar et al. (2016). This function calculates
bin statistics, including mean, standard deviation, total alive, total dead,
count, and percentage for each bin.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">nonlinear_bins</span><span class="op">(</span></span>
<span>  <span class="va">data</span>,</span>
<span>  <span class="va">Ps_col</span>,</span>
<span>  <span class="va">outcome_col</span>,</span>
<span>  group_vars <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  divisor1 <span class="op">=</span> <span class="fl">5</span>,</span>
<span>  divisor2 <span class="op">=</span> <span class="fl">5</span>,</span>
<span>  threshold_1 <span class="op">=</span> <span class="fl">0.9</span>,</span>
<span>  threshold_2 <span class="op">=</span> <span class="fl">0.99</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-data">data<a class="anchor" aria-label="anchor" href="#arg-data"></a></dt>
<dd><p>A <code>data.frame</code> or <code>tibble</code> containing the probability of survival
data for a set of patients.</p></dd>


<dt id="arg-ps-col">Ps_col<a class="anchor" aria-label="anchor" href="#arg-ps-col"></a></dt>
<dd><p>The name of the column containing the survival probabilities
(Ps). Should be numeric on a scale from 0 to 1.</p></dd>


<dt id="arg-outcome-col">outcome_col<a class="anchor" aria-label="anchor" href="#arg-outcome-col"></a></dt>
<dd><p>The name of the column containing the outcome data. It
should be binary, with values indicating patient survival. A value of <code>1</code>
should represent "alive" (survived), while <code>0</code> should represent "dead" (did
not survive).  <code>TRUE/FALSE</code> are accepted as well. Ensure the column
contains only these possible values.</p></dd>


<dt id="arg-group-vars">group_vars<a class="anchor" aria-label="anchor" href="#arg-group-vars"></a></dt>
<dd><p>Optional grouping variables for bin statistics
calculations. These should be specified as quoted column names.</p></dd>


<dt id="arg-divisor-">divisor1<a class="anchor" aria-label="anchor" href="#arg-divisor-"></a></dt>
<dd><p>A positive numeric value controlling the coarseness of bins
for Ps values below <code>threshold_1</code>. It scales the number of steps from the
start of the dataset up to the <code>threshold_1</code> cut point. Larger values
produce fewer, broader bins; smaller values produce more, narrower bins.
Defaults to <code>5</code>.</p></dd>


<dt id="arg-divisor-">divisor2<a class="anchor" aria-label="anchor" href="#arg-divisor-"></a></dt>
<dd><p>A positive numeric value controlling the coarseness of bins
for Ps values between <code>threshold_1</code> and <code>threshold_2</code>. Larger values yield
wider bins, and smaller values yield narrower bins in this range. Defaults
to <code>5</code>.</p></dd>


<dt id="arg-threshold-">threshold_1<a class="anchor" aria-label="anchor" href="#arg-threshold-"></a></dt>
<dd><p>A numeric value that defines the lower bound of the
high-survival probability range in <code>Ps_col</code>. The function identifies the
first index where <code>Ps_col</code> exceeds this value and begins applying smaller
bin widths from that point onward. Defaults to <code>0.9</code>, meaning binning
changes once Ps &gt; 0.90.</p></dd>


<dt id="arg-threshold-">threshold_2<a class="anchor" aria-label="anchor" href="#arg-threshold-"></a></dt>
<dd><p>A numeric value that defines the upper bound of the
high-survival probability range in <code>Ps_col</code>. The function identifies the
first index where <code>Ps_col</code> exceeds this value. Between <code>threshold_1</code> and
<code>threshold_2</code>, finer binning is applied; above <code>threshold_2</code>, binning may
again change. Defaults to <code>0.99</code>, meaning the special binning range is
between Ps values of 0.90 and 0.99.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A list with two elements:</p><ul><li><p><code>intervals</code>: A vector defining bin boundaries for probability of
survival.</p></li>
<li><p><code>bin_stats</code>: A <code>tibble</code> containing:</p><ul><li><p><code>bin_number</code>: Bin index.</p></li>
<li><p><code>bin_start</code>, <code>bin_end</code>: Bin range.</p></li>
<li><p><code>mean</code>, <code>sd</code>: Mean and standard deviation of <code>Ps_col</code> within the bin.</p></li>
<li><p><code>Pred_Survivors_b</code>, <code>Pred_Deaths_b</code>: Predicted counts of survivors and
decedents, respectively.</p></li>
<li><p><code>AntiS_b</code>, <code>AntiM_b</code>: Anticipated proportion survived, and deceased,
respectively.</p></li>
<li><p><code>alive</code>, <code>dead</code>: Count of observed survivors and non-survivors.</p></li>
<li><p><code>count</code>: Total records in the bin.</p></li>
<li><p><code>percent</code>: Percentage of total records within each bin.</p></li>
</ul></li>
</ul></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>Like other statistical computing functions, <code>nonlinear_bins()</code> is happiest
without missing data.  It is best to pass complete probability of survival
and outcome data to the function for optimal performance. With smaller
datasets, this is especially helpful.  However, <code>nonlinear_bins()</code> will throw
a warning about missing values, if any exist in <code>Ps_col</code> and/or
<code>outcome_col</code>.</p>
<p><code>nonlinear_bins()</code> assumes <code>Ps_col</code> contains probabilities derived from
real-world inputs for the Trauma Injury Severity Score (TRISS) model.
Synthetic or low-variability data (especially with small sample sizes) may
not reflect the distribution of TRISS-derived survival probabilities. This
can result in unstable estimates or function failure due to insufficient
dispersion. With small sample sizes, it may be important to use smaller
values with the divisor arguments and adjust the thresholds (based on the
distribution of the <code>Ps_col</code> values) to create bins that better accommodate
the data.</p>
<p>By default, <code>nonlinear_bins()</code> derives bin cut points from the full dataset’s
distribution. This ensures comparability across groups when <code>group_vars</code> is
used. To tailor binning to a specific group (e.g., a single hospital), filter
the dataset to that subgroup before calling <code>nonlinear_bins()</code>. The function
will then compute bins and related statistics using only that subset’s
<code>Ps_col</code> distribution. When <code>group_vars</code> is used, and ff a group lacks
observations within one or more bins, <code><a href="rm_bin_summary.html">rm_bin_summary()</a></code> will compute
statistics only for the bins that contain data. Bins with no observations are
excluded from the summary for that group.</p>
<p>The <code>threshold_1</code> and <code>threshold_2</code> arguments set probability cut points
that define the start and end of a high-survival range where bin widths are
adjusted for finer resolution. The <code>divisor1</code> and <code>divisor2</code> arguments are
scaling factors that determine how many bins are created before and within
this high-survival range, respectively. Lower divisors yield narrower bins,
capturing more detail, while higher divisors yield broader bins, smoothing
the distribution.</p>
    </div>
    <div class="section level2">
    <h2 id="note">Note<a class="anchor" aria-label="anchor" href="#note"></a></h2>
    <p>This function will produce the most reliable and interpretable results when
using a dataset that has one row per patient, with each column being a
feature.</p>
<p>The <code>mean</code> and <code>AntiS_b</code> are approximately equivalent in this context.  They
are kept in the output for clarity.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Kassar, O.M., Eklund, E.A., Barnhardt, W.F., Napoli, N.J., Barnes, L.E.,
Young, J.S. (2016). Trauma survival margin analysis: A dissection of trauma
center performance through initial lactate. The American Surgeon, 82(7),
649-653. <a href="doi:10.1177/000313481608200733">doi:10.1177/000313481608200733</a></p>
<p>Napoli, N. J., Barnhardt, W., Kotoriy, M. E., Young, J. S., &amp; Barnes, L. E.
(2017). Relative mortality analysis: A new tool to evaluate clinical
performance in trauma centers. IISE Transactions on Healthcare Systems
Engineering, 7(3), 181–191. <a href="doi:10.1080/24725579.2017.1325948">doi:10.1080/24725579.2017.1325948</a></p>
<p>Schroeder, P. H., Napoli, N. J., Barnhardt, W. F., Barnes, L. E., &amp; Young, J.
S. (2018). Relative mortality analysis of the “golden hour”: A comprehensive
acuity stratification approach to address disagreement in current literature.
Prehospital Emergency Care, 23(2), 254–262.
<a href="doi:10.1080/10903127.2018.1489021">doi:10.1080/10903127.2018.1489021</a></p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="probability_of_survival.html">probability_of_survival()</a></code>, <code><a href="rmm.html">rmm()</a></code>, and <code><a href="rm_bin_summary.html">rm_bin_summary()</a></code></p></div>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Nicolas Foss, Ed.D, MS, original implementation in MATLAB by Nicholas
J. Napoli, Ph.D., MS</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># Generate example data</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Parameters</span></span></span>
<span class="r-in"><span><span class="co"># Total number of patients</span></span></span>
<span class="r-in"><span><span class="va">n_patients</span> <span class="op">&lt;-</span> <span class="fl">5000</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Arbitrary group labels</span></span></span>
<span class="r-in"><span><span class="va">groups</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">LETTERS</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">]</span>, size <span class="op">=</span> <span class="va">n_patients</span>, replace <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Trauma types</span></span></span>
<span class="r-in"><span><span class="va">trauma_type_values</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Blunt"</span>, <span class="st">"Penetrating"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  size <span class="op">=</span> <span class="va">n_patients</span>,</span></span>
<span class="r-in"><span>  replace <span class="op">=</span> <span class="cn">TRUE</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># RTS values</span></span></span>
<span class="r-in"><span><span class="va">rts_values</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span>from <span class="op">=</span> <span class="fl">0</span>, to <span class="op">=</span> <span class="fl">7.8408</span>, by <span class="op">=</span> <span class="fl">0.005</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  size <span class="op">=</span> <span class="va">n_patients</span>,</span></span>
<span class="r-in"><span>  replace <span class="op">=</span> <span class="cn">TRUE</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># patient ages</span></span></span>
<span class="r-in"><span><span class="va">ages</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span>from <span class="op">=</span> <span class="fl">0</span>, to <span class="op">=</span> <span class="fl">100</span>, by <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  size <span class="op">=</span> <span class="va">n_patients</span>,</span></span>
<span class="r-in"><span>  replace <span class="op">=</span> <span class="cn">TRUE</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># ISS scores</span></span></span>
<span class="r-in"><span><span class="va">iss_scores</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span>from <span class="op">=</span> <span class="fl">0</span>, to <span class="op">=</span> <span class="fl">75</span>, by <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  size <span class="op">=</span> <span class="va">n_patients</span>,</span></span>
<span class="r-in"><span>  replace <span class="op">=</span> <span class="cn">TRUE</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Generate survival probabilities (Ps)</span></span></span>
<span class="r-in"><span><span class="va">Ps</span> <span class="op">&lt;-</span> <span class="fu">traumar</span><span class="fu">::</span><span class="fu"><a href="probability_of_survival.html">probability_of_survival</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  trauma_type <span class="op">=</span> <span class="va">trauma_type_values</span>,</span></span>
<span class="r-in"><span>  age <span class="op">=</span> <span class="va">ages</span>,</span></span>
<span class="r-in"><span>  rts <span class="op">=</span> <span class="va">rts_values</span>,</span></span>
<span class="r-in"><span>  iss <span class="op">=</span> <span class="va">iss_scores</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Simulate survival outcomes based on Ps</span></span></span>
<span class="r-in"><span><span class="va">survival_outcomes</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html" class="external-link">rbinom</a></span><span class="op">(</span><span class="va">n_patients</span>, size <span class="op">=</span> <span class="fl">1</span>, prob <span class="op">=</span> <span class="va">Ps</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Create data frame</span></span></span>
<span class="r-in"><span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>Ps <span class="op">=</span> <span class="va">Ps</span>, survival <span class="op">=</span> <span class="va">survival_outcomes</span>, groups <span class="op">=</span> <span class="va">groups</span><span class="op">)</span> <span class="op">|&gt;</span></span></span>
<span class="r-in"><span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>death <span class="op">=</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/if_else.html" class="external-link">if_else</a></span><span class="op">(</span><span class="va">survival</span> <span class="op">==</span> <span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Apply the nonlinear_bins function</span></span></span>
<span class="r-in"><span><span class="va">results</span> <span class="op">&lt;-</span> <span class="fu">nonlinear_bins</span><span class="op">(</span></span></span>
<span class="r-in"><span>  data <span class="op">=</span> <span class="va">data</span>,</span></span>
<span class="r-in"><span>  Ps_col <span class="op">=</span> <span class="va">Ps</span>,</span></span>
<span class="r-in"><span>  outcome_col <span class="op">=</span> <span class="va">survival</span>,</span></span>
<span class="r-in"><span>  divisor1 <span class="op">=</span> <span class="fl">4</span>,</span></span>
<span class="r-in"><span>  divisor2 <span class="op">=</span> <span class="fl">4</span>,</span></span>
<span class="r-in"><span>  threshold_1 <span class="op">=</span> <span class="fl">0.9</span>,</span></span>
<span class="r-in"><span>  threshold_2 <span class="op">=</span> <span class="fl">0.99</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># View results</span></span></span>
<span class="r-in"><span><span class="va">results</span><span class="op">$</span><span class="va">intervals</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.0002015449 0.0256191282 0.1455317587 0.4842820556 0.9003870455</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [6] 0.9285354475 0.9518925450 0.9722272703 0.9968989233</span>
<span class="r-in"><span><span class="va">results</span><span class="op">$</span><span class="va">bin_stats</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 8 × 13</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   bin_number bin_start bin_end    mean      sd Pred_Survivors_b Pred_Deaths_b</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>            <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>         <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">1</span>          1  0.000<span style="text-decoration: underline;">202</span>  0.025<span style="text-decoration: underline;">6</span> 0.009<span style="text-decoration: underline;">35</span> 0.007<span style="text-decoration: underline;">22</span>             10.4       <span style="text-decoration: underline;">1</span>106.  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">2</span>          2  0.025<span style="text-decoration: underline;">6</span>    0.146  0.073<span style="text-decoration: underline;">2</span>  0.034<span style="text-decoration: underline;">5</span>              81.7       <span style="text-decoration: underline;">1</span>033.  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">3</span>          3  0.146     0.484  0.293   0.095<span style="text-decoration: underline;">9</span>             327.         788.  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">4</span>          4  0.484     0.900  0.697   0.124              777.         337.  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">5</span>          5  0.900     0.929  0.916   0.007<span style="text-decoration: underline;">90</span>            114.          10.5 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">6</span>          6  0.929     0.952  0.940   0.006<span style="text-decoration: underline;">80</span>            117.           7.50</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">7</span>          7  0.952     0.972  0.963   0.005<span style="text-decoration: underline;">64</span>            120.           4.65</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">8</span>          8  0.972     0.997  0.984   0.006<span style="text-decoration: underline;">86</span>            162.           2.67</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># ℹ 6 more variables: AntiS_b &lt;dbl&gt;, AntiM_b &lt;dbl&gt;, alive &lt;int&gt;, dead &lt;int&gt;,</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;">#   count &lt;int&gt;, percent &lt;dbl&gt;</span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Example with grouping by a categorical variable</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Run the function using a single grouping variable</span></span></span>
<span class="r-in"><span><span class="va">results_grouped</span> <span class="op">&lt;-</span> <span class="fu">nonlinear_bins</span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="va">data</span>,</span></span>
<span class="r-in"><span>  Ps_col <span class="op">=</span> <span class="va">Ps</span>,</span></span>
<span class="r-in"><span>  outcome_col <span class="op">=</span> <span class="va">survival</span>,</span></span>
<span class="r-in"><span>  group_vars <span class="op">=</span> <span class="st">"groups"</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># View grouped results</span></span></span>
<span class="r-in"><span><span class="va">results_grouped</span><span class="op">$</span><span class="va">bin_stats</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 20 × 14</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    groups bin_number bin_start bin_end    mean      sd Pred_Survivors_b</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>            <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 1</span> A               1  0.000<span style="text-decoration: underline;">202</span>  0.016<span style="text-decoration: underline;">5</span> 0.006<span style="text-decoration: underline;">36</span> 0.004<span style="text-decoration: underline;">65</span>             2.94</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 2</span> A               2  0.016<span style="text-decoration: underline;">5</span>    0.079<span style="text-decoration: underline;">4</span> 0.041<span style="text-decoration: underline;">8</span>  0.018<span style="text-decoration: underline;">3</span>             19.1 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 3</span> A               3  0.079<span style="text-decoration: underline;">4</span>    0.252  0.155   0.051<span style="text-decoration: underline;">6</span>             68.5 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 4</span> A               4  0.252     0.570  0.393   0.095<span style="text-decoration: underline;">3</span>            172.  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 5</span> A               5  0.570     0.900  0.734   0.097<span style="text-decoration: underline;">6</span>            320.  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 6</span> A               6  0.900     0.923  0.912   0.006<span style="text-decoration: underline;">60</span>            39.2 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 7</span> A               7  0.923     0.941  0.933   0.005<span style="text-decoration: underline;">41</span>            47.6 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 8</span> A               8  0.941     0.962  0.952   0.005<span style="text-decoration: underline;">87</span>            44.7 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 9</span> A               9  0.962     0.976  0.968   0.004<span style="text-decoration: underline;">26</span>            54.2 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">10</span> A              10  0.976     0.997  0.986   0.006<span style="text-decoration: underline;">10</span>            64.1 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">11</span> B               1  0.000<span style="text-decoration: underline;">202</span>  0.016<span style="text-decoration: underline;">5</span> 0.006<span style="text-decoration: underline;">57</span> 0.004<span style="text-decoration: underline;">66</span>             2.83</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">12</span> B               2  0.016<span style="text-decoration: underline;">5</span>    0.079<span style="text-decoration: underline;">4</span> 0.041<span style="text-decoration: underline;">7</span>  0.018<span style="text-decoration: underline;">0</span>             18.1 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">13</span> B               3  0.079<span style="text-decoration: underline;">4</span>    0.252  0.153   0.049<span style="text-decoration: underline;">6</span>             68.7 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">14</span> B               4  0.252     0.570  0.405   0.092<span style="text-decoration: underline;">0</span>            184.  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">15</span> B               5  0.570     0.900  0.746   0.100             340.  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">16</span> B               6  0.900     0.923  0.914   0.006<span style="text-decoration: underline;">59</span>            52.1 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">17</span> B               7  0.923     0.941  0.933   0.005<span style="text-decoration: underline;">10</span>            45.7 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">18</span> B               8  0.941     0.962  0.952   0.005<span style="text-decoration: underline;">53</span>            50.5 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">19</span> B               9  0.962     0.976  0.969   0.003<span style="text-decoration: underline;">71</span>            42.6 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">20</span> B              10  0.976     0.997  0.985   0.005<span style="text-decoration: underline;">50</span>            73.9 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># ℹ 7 more variables: Pred_Deaths_b &lt;dbl&gt;, AntiS_b &lt;dbl&gt;, AntiM_b &lt;dbl&gt;,</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;">#   alive &lt;int&gt;, dead &lt;int&gt;, count &lt;int&gt;, percent &lt;dbl&gt;</span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Nicolas Foss.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

