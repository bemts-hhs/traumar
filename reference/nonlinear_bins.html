<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Create Nonlinear Probability of Survival Bins — nonlinear_bins • traumar</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Create Nonlinear Probability of Survival Bins — nonlinear_bins"><meta name="description" content="This function generates nonlinear bins for probability of survival data based
on specified thresholds and divisors as specified in Napoli et al. (2017),
Schroeder et al. (2019), and Kassar et al. (2016). This function calculates
bin statistics, including mean, standard deviation, total alive, total dead,
count, and percentage for each bin."><meta property="og:description" content="This function generates nonlinear bins for probability of survival data based
on specified thresholds and divisors as specified in Napoli et al. (2017),
Schroeder et al. (2019), and Kassar et al. (2016). This function calculates
bin statistics, including mean, standard deviation, total alive, total dead,
count, and percentage for each bin."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">traumar</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/bemts-hhs/traumar/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Create Nonlinear Probability of Survival Bins</h1>
      <small class="dont-index">Source: <a href="https://github.com/bemts-hhs/traumar/blob/v1.0.0/R/non_linear_bins.R" class="external-link"><code>R/non_linear_bins.R</code></a></small>
      <div class="d-none name"><code>nonlinear_bins.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This function generates nonlinear bins for probability of survival data based
on specified thresholds and divisors as specified in Napoli et al. (2017),
Schroeder et al. (2019), and Kassar et al. (2016). This function calculates
bin statistics, including mean, standard deviation, total alive, total dead,
count, and percentage for each bin.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">nonlinear_bins</span><span class="op">(</span></span>
<span>  <span class="va">data</span>,</span>
<span>  <span class="va">Ps_col</span>,</span>
<span>  <span class="va">outcome_col</span>,</span>
<span>  divisor1 <span class="op">=</span> <span class="fl">5</span>,</span>
<span>  divisor2 <span class="op">=</span> <span class="fl">5</span>,</span>
<span>  threshold_1 <span class="op">=</span> <span class="fl">0.9</span>,</span>
<span>  threshold_2 <span class="op">=</span> <span class="fl">0.99</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-data">data<a class="anchor" aria-label="anchor" href="#arg-data"></a></dt>
<dd><p>A <code>data.frame</code> or <code>tibble</code> containing the probability of survival
data for a set of patients.</p></dd>


<dt id="arg-ps-col">Ps_col<a class="anchor" aria-label="anchor" href="#arg-ps-col"></a></dt>
<dd><p>The column in <code>data</code> containing the probability of survival
values for a set of patients.</p></dd>


<dt id="arg-outcome-col">outcome_col<a class="anchor" aria-label="anchor" href="#arg-outcome-col"></a></dt>
<dd><p>The name of the column containing the outcome data. It
should be binary, with values indicating patient survival. A value of <code>1</code>
should represent "alive" (survived), while <code>0</code> should
represent "dead" (did not survive). Ensure the column contains only these
two possible values.</p></dd>


<dt id="arg-divisor-">divisor1<a class="anchor" aria-label="anchor" href="#arg-divisor-"></a></dt>
<dd><p>A parameter to control the width of the probability of
survival range bins. Affects the creation of step sizes for the beginning
of each bin range. Defaults to <code>5</code>.</p></dd>


<dt id="arg-divisor-">divisor2<a class="anchor" aria-label="anchor" href="#arg-divisor-"></a></dt>
<dd><p>A parameter to control the width of the probability of
survival range bins. Affects the creation of step sizes for the beginning
of each bin range. Defaults to <code>5</code>.</p></dd>


<dt id="arg-threshold-">threshold_1<a class="anchor" aria-label="anchor" href="#arg-threshold-"></a></dt>
<dd><p>A parameter to decide where data indices will begin to
create step sizes. Defaults to <code>0.9</code>.</p></dd>


<dt id="arg-threshold-">threshold_2<a class="anchor" aria-label="anchor" href="#arg-threshold-"></a></dt>
<dd><p>A parameter to decide where data indices will end to
create step sizes. Defaults to <code>0.99</code>.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A list with <code>intervals</code> and <code>bin_stats</code> objects:</p><ul><li><p><code>intervals</code>: A vector of start and end-points for the probability of survival bin ranges.</p></li>
<li><p><code>bin_stats</code>: A <code>tibble</code> with columns <code>bin_number</code>, <code>bin_start</code>, <code>bin_end</code>, <code>mean</code>, <code>sd</code>,
<code>alive</code>, <code>dead</code>, <code>count</code>, and <code>percent</code>.</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Nicolas Foss, Ed.D, MS, original paper and code in MATLAB by Nicholas
J. Napoli, Ph.D., MS</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># Generate example data with high negative skewness</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Parameters</span></span></span>
<span class="r-in"><span><span class="va">n_patients</span> <span class="op">&lt;-</span> <span class="fl">10000</span>  <span class="co"># Total number of patients</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Skewed towards higher values</span></span></span>
<span class="r-in"><span><span class="va">Ps</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Logistic.html" class="external-link">plogis</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">n_patients</span>, mean <span class="op">=</span> <span class="fl">2</span>, sd <span class="op">=</span> <span class="fl">1.5</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Simulate survival outcomes based on Ps</span></span></span>
<span class="r-in"><span><span class="va">survival_outcomes</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html" class="external-link">rbinom</a></span><span class="op">(</span><span class="va">n_patients</span>,</span></span>
<span class="r-in"><span>                            size <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>                            prob <span class="op">=</span> <span class="va">Ps</span></span></span>
<span class="r-in"><span>                            <span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Create data frame</span></span></span>
<span class="r-in"><span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>Ps <span class="op">=</span> <span class="va">Ps</span>, survival <span class="op">=</span> <span class="va">survival_outcomes</span><span class="op">)</span> <span class="op">|&gt;</span></span></span>
<span class="r-in"><span><span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>death <span class="op">=</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/if_else.html" class="external-link">if_else</a></span><span class="op">(</span><span class="va">survival</span> <span class="op">==</span> <span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Apply the nonlinear_bins function</span></span></span>
<span class="r-in"><span><span class="va">results</span> <span class="op">&lt;-</span> <span class="fu">nonlinear_bins</span><span class="op">(</span>data <span class="op">=</span> <span class="va">data</span>,</span></span>
<span class="r-in"><span>                          Ps_col <span class="op">=</span> <span class="va">Ps</span>,</span></span>
<span class="r-in"><span>                          outcome_col <span class="op">=</span> <span class="va">survival</span>,</span></span>
<span class="r-in"><span>                          divisor1 <span class="op">=</span> <span class="fl">5</span>,</span></span>
<span class="r-in"><span>                          divisor2 <span class="op">=</span> <span class="fl">5</span>,</span></span>
<span class="r-in"><span>                          threshold_1 <span class="op">=</span> <span class="fl">0.9</span>,</span></span>
<span class="r-in"><span>                          threshold_2 <span class="op">=</span> <span class="fl">0.99</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># View results</span></span></span>
<span class="r-in"><span><span class="va">results</span><span class="op">$</span><span class="va">intervals</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1] 0.02257717 0.54234698 0.70154257 0.79581165 0.85714527 0.90005763</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [7] 0.92518915 0.94603830 0.96266743 0.97623957 0.99957866</span>
<span class="r-in"><span><span class="va">results</span><span class="op">$</span><span class="va">bin_stats</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 10 × 13</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    bin_number bin_start bin_end  mean      sd Pred_Survivors_b Pred_Deaths_b</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>            <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>         <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 1</span>          1    0.022<span style="text-decoration: underline;">6</span>   0.542 0.378 0.122               419.         692. </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 2</span>          2    0.542    0.702 0.628 0.045<span style="text-decoration: underline;">8</span>              698.         413. </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 3</span>          3    0.702    0.796 0.752 0.027<span style="text-decoration: underline;">1</span>              836.         275. </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 4</span>          4    0.796    0.857 0.829 0.017<span style="text-decoration: underline;">3</span>              921.         190. </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 5</span>          5    0.857    0.900 0.879 0.012<span style="text-decoration: underline;">6</span>              976.         134. </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 6</span>          6    0.900    0.925 0.913 0.007<span style="text-decoration: underline;">23</span>             735.          70.0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 7</span>          7    0.925    0.946 0.936 0.005<span style="text-decoration: underline;">96</span>             753.          51.8</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 8</span>          8    0.946    0.963 0.954 0.004<span style="text-decoration: underline;">73</span>             768.          36.7</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 9</span>          9    0.963    0.976 0.970 0.004<span style="text-decoration: underline;">06</span>             781.          24.4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">10</span>         10    0.976    1.00  0.987 0.006<span style="text-decoration: underline;">21</span>            <span style="text-decoration: underline;">1</span>210.          16.2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># ℹ 6 more variables: AntiS_b &lt;dbl&gt;, AntiM_b &lt;dbl&gt;, alive &lt;dbl&gt;, dead &lt;dbl&gt;,</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;">#   count &lt;dbl&gt;, percent &lt;dbl&gt;</span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Nicolas Foss.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

