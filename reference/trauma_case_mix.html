<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>View the Current Patient Population Case Mix Compared to the Major Trauma Study Case Mix — trauma_case_mix • traumar</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="View the Current Patient Population Case Mix Compared to the Major Trauma Study Case Mix — trauma_case_mix"><meta name="description" content="This function compares the current patient population's case mix (based on
probability of survival, Ps) to the MTOS case mix by binning patients into
specific Ps ranges. It returns the fraction of patients in each range and
compares it to the MTOS distribution. For more information on the methods
used in these calculations, please see Flora (1978) and Boyd et al. (1987)."><meta property="og:description" content="This function compares the current patient population's case mix (based on
probability of survival, Ps) to the MTOS case mix by binning patients into
specific Ps ranges. It returns the fraction of patients in each range and
compares it to the MTOS distribution. For more information on the methods
used in these calculations, please see Flora (1978) and Boyd et al. (1987)."><meta property="og:image" content="https://bemts-hhs.github.io/traumar/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">traumar</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.2.1</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/bemts-hhs/traumar/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>View the Current Patient Population Case Mix Compared to the Major Trauma Study Case Mix</h1>
      <small class="dont-index">Source: <a href="https://github.com/bemts-hhs/traumar/blob/main/R/trauma_case_mix.r" class="external-link"><code>R/trauma_case_mix.r</code></a></small>
      <div class="d-none name"><code>trauma_case_mix.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This function compares the current patient population's case mix (based on
probability of survival, Ps) to the MTOS case mix by binning patients into
specific Ps ranges. It returns the fraction of patients in each range and
compares it to the MTOS distribution. For more information on the methods
used in these calculations, please see Flora (1978) and Boyd et al. (1987).</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">trauma_case_mix</span><span class="op">(</span><span class="va">df</span>, <span class="va">Ps_col</span>, <span class="va">outcome_col</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-df">df<a class="anchor" aria-label="anchor" href="#arg-df"></a></dt>
<dd><p>A data frame containing patient data.</p></dd>


<dt id="arg-ps-col">Ps_col<a class="anchor" aria-label="anchor" href="#arg-ps-col"></a></dt>
<dd><p>The name of the column containing the probability of survival
(Ps) values.</p></dd>


<dt id="arg-outcome-col">outcome_col<a class="anchor" aria-label="anchor" href="#arg-outcome-col"></a></dt>
<dd><p>The name of the column containing the binary outcome data
(valid values are 1 or TRUE for alive, 0 or FALSE for dead).</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A data frame containing:</p><ul><li><p><code>Ps_range</code>: The probability of survival range category.</p></li>
<li><p><code>current_fraction</code>: The fraction of patients in the current
dataset within each Ps range.</p></li>
<li><p><code>MTOS_distribution</code>: The reference distribution of patients in
each Ps range based on the MTOS study.</p></li>
<li><p><code>survivals</code>: The number of observed survivors (outcome = 1) in
each Ps range.</p></li>
<li><p><code>predicted_survivals</code>: The sum of predicted survivals (sum of
Ps values) in each Ps range.</p></li>
<li><p><code>deaths</code>: The number of observed deaths (outcome = 0) in each
Ps range.</p></li>
<li><p><code>predicted_deaths</code>: The sum of predicted deaths (sum of 1 - Ps
values) in each Ps range.</p></li>
<li><p><code>count</code>: The total number of patients in each Ps range.</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The function checks whether the <code>outcome_col</code> contains values representing a
binary outcome. It also ensures that <code>Ps_col</code> contains numeric values within
the range 0 to 1. If any values exceed 1, a warning is issued. The patients
are then grouped into predefined Ps ranges, and the function compares the
fraction of patients in each range with the MTOS case mix distribution.</p>
<p>Like other statistical computing functions, <code>trauma_case_mix()</code> is happiest
without missing data.  It is best to pass complete probability of survival
and outcome data to the function for optimal performance. With smaller
datasets, this is especially helpful.  However, <code>trauma_case_mix()</code> will
throw a warning about missing values, if any exist in <code>Ps_col</code> and/or
<code>outcome_col</code>.</p>
    </div>
    <div class="section level2">
    <h2 id="note">Note<a class="anchor" aria-label="anchor" href="#note"></a></h2>
    <p>This function will produce the most reliable and interpretable results when
using a dataset that has one row per patient, with each column being a
feature.</p>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Nicolas Foss, Ed.D., MS</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># Generate example data</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Parameters</span></span></span>
<span class="r-in"><span><span class="co"># Total number of patients</span></span></span>
<span class="r-in"><span><span class="va">n_patients</span> <span class="op">&lt;-</span> <span class="fl">5000</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Arbitrary group labels</span></span></span>
<span class="r-in"><span><span class="va">groups</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">LETTERS</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">]</span>, size <span class="op">=</span> <span class="va">n_patients</span>, replace <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Trauma types</span></span></span>
<span class="r-in"><span><span class="va">trauma_type_values</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Blunt"</span>, <span class="st">"Penetrating"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  size <span class="op">=</span> <span class="va">n_patients</span>,</span></span>
<span class="r-in"><span>  replace <span class="op">=</span> <span class="cn">TRUE</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># RTS values</span></span></span>
<span class="r-in"><span><span class="va">rts_values</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span>from <span class="op">=</span> <span class="fl">0</span>, to <span class="op">=</span> <span class="fl">7.8408</span>, by <span class="op">=</span> <span class="fl">0.005</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  size <span class="op">=</span> <span class="va">n_patients</span>,</span></span>
<span class="r-in"><span>  replace <span class="op">=</span> <span class="cn">TRUE</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># patient ages</span></span></span>
<span class="r-in"><span><span class="va">ages</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span>from <span class="op">=</span> <span class="fl">0</span>, to <span class="op">=</span> <span class="fl">100</span>, by <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  size <span class="op">=</span> <span class="va">n_patients</span>,</span></span>
<span class="r-in"><span>  replace <span class="op">=</span> <span class="cn">TRUE</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># ISS scores</span></span></span>
<span class="r-in"><span><span class="va">iss_scores</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span>from <span class="op">=</span> <span class="fl">0</span>, to <span class="op">=</span> <span class="fl">75</span>, by <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  size <span class="op">=</span> <span class="va">n_patients</span>,</span></span>
<span class="r-in"><span>  replace <span class="op">=</span> <span class="cn">TRUE</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Generate survival probabilities (Ps)</span></span></span>
<span class="r-in"><span><span class="va">Ps</span> <span class="op">&lt;-</span> <span class="fu">traumar</span><span class="fu">::</span><span class="fu"><a href="probability_of_survival.html">probability_of_survival</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  trauma_type <span class="op">=</span> <span class="va">trauma_type_values</span>,</span></span>
<span class="r-in"><span>  age <span class="op">=</span> <span class="va">ages</span>,</span></span>
<span class="r-in"><span>  rts <span class="op">=</span> <span class="va">rts_values</span>,</span></span>
<span class="r-in"><span>  iss <span class="op">=</span> <span class="va">iss_scores</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Simulate survival outcomes based on Ps</span></span></span>
<span class="r-in"><span><span class="va">survival_outcomes</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html" class="external-link">rbinom</a></span><span class="op">(</span><span class="va">n_patients</span>, size <span class="op">=</span> <span class="fl">1</span>, prob <span class="op">=</span> <span class="va">Ps</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Create data frame</span></span></span>
<span class="r-in"><span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>Ps <span class="op">=</span> <span class="va">Ps</span>, survival <span class="op">=</span> <span class="va">survival_outcomes</span>, groups <span class="op">=</span> <span class="va">groups</span><span class="op">)</span> <span class="op">|&gt;</span></span></span>
<span class="r-in"><span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>death <span class="op">=</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/if_else.html" class="external-link">if_else</a></span><span class="op">(</span><span class="va">survival</span> <span class="op">==</span> <span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Compare the current case mix with the MTOS case mix</span></span></span>
<span class="r-in"><span><span class="fu">trauma_case_mix</span><span class="op">(</span><span class="va">data</span>, Ps_col <span class="op">=</span> <span class="va">Ps</span>, outcome_col <span class="op">=</span> <span class="va">death</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      Ps_range current_fraction MTOS_distribution survivals predicted_survivals</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 0.00 - 0.25           0.5414             0.010      2534            187.9191</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2 0.26 - 0.50           0.1432             0.043       468            269.5871</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3 0.51 - 0.75           0.1278             0.000       217            405.8877</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4 0.76 - 0.90           0.0870             0.052        58            366.1312</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5 0.91 - 0.95           0.0508             0.053        18            237.6390</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6 0.96 - 1.00           0.0498             0.842         4            243.4833</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   deaths predicted_deaths count</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1    173      2519.080869  2707</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2    248       446.412896   716</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3    422       233.112251   639</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4    377        68.868790   435</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5    236        16.361033   254</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6    245         5.516716   249</span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Nicolas Foss.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

