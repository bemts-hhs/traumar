<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Bin-Level Summary for Relative Mortality Metric (RMM) — rm_bin_summary • traumar</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Bin-Level Summary for Relative Mortality Metric (RMM) — rm_bin_summary"><meta name="description" content="Calculates a bin-level summary for the Relative Mortality Metric (RMM) from
Napoli et al. (2017) by grouping data into bins based on survival
probabilities (Ps) and summarizing outcomes within each bin. This function
returns statistics such as total alive, total dead, estimated mortality,
anticipated mortality, and confidence intervals for each bin."><meta property="og:description" content="Calculates a bin-level summary for the Relative Mortality Metric (RMM) from
Napoli et al. (2017) by grouping data into bins based on survival
probabilities (Ps) and summarizing outcomes within each bin. This function
returns statistics such as total alive, total dead, estimated mortality,
anticipated mortality, and confidence intervals for each bin."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">traumar</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.1</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Bin-Level Summary for Relative Mortality Metric (RMM)</h1>

      <div class="d-none name"><code>rm_bin_summary.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Calculates a bin-level summary for the Relative Mortality Metric (RMM) from
Napoli et al. (2017) by grouping data into bins based on survival
probabilities (Ps) and summarizing outcomes within each bin. This function
returns statistics such as total alive, total dead, estimated mortality,
anticipated mortality, and confidence intervals for each bin.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">rm_bin_summary</span><span class="op">(</span></span>
<span>  <span class="va">data</span>,</span>
<span>  <span class="va">Ps_col</span>,</span>
<span>  <span class="va">outcome_col</span>,</span>
<span>  Divisor1 <span class="op">=</span> <span class="fl">5</span>,</span>
<span>  Divisor2 <span class="op">=</span> <span class="fl">5</span>,</span>
<span>  Threshold_1 <span class="op">=</span> <span class="fl">0.9</span>,</span>
<span>  Threshold_2 <span class="op">=</span> <span class="fl">0.99</span>,</span>
<span>  Z <span class="op">=</span> <span class="fl">1.96</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-data">data<a class="anchor" aria-label="anchor" href="#arg-data"></a></dt>
<dd><p>A data frame or tibble containing the data.</p></dd>


<dt id="arg-ps-col">Ps_col<a class="anchor" aria-label="anchor" href="#arg-ps-col"></a></dt>
<dd><p>The name of the column containing the survival probabilities
(Ps). Should be numeric (values between 0 and 100).</p></dd>


<dt id="arg-outcome-col">outcome_col<a class="anchor" aria-label="anchor" href="#arg-outcome-col"></a></dt>
<dd><p>The name of the column containing the outcome data. It
should be binary, with values indicating patient survival. A value of `1`
or `TRUE` should represent "alive" (survived), while `0` or `FALSE` should
represent "dead" (did not survive). Ensure the column contains only these
two possible values.</p></dd>


<dt id="arg-divisor-">Divisor1<a class="anchor" aria-label="anchor" href="#arg-divisor-"></a></dt>
<dd><p>A divisor used for binning the survival probabilities
(default is 5).</p></dd>


<dt id="arg-divisor-">Divisor2<a class="anchor" aria-label="anchor" href="#arg-divisor-"></a></dt>
<dd><p>A second divisor used for binning the survival probabilities
(default is 5).</p></dd>


<dt id="arg-threshold-">Threshold_1<a class="anchor" aria-label="anchor" href="#arg-threshold-"></a></dt>
<dd><p>The first threshold for dividing the survival
probabilities (default is 0.9).</p></dd>


<dt id="arg-threshold-">Threshold_2<a class="anchor" aria-label="anchor" href="#arg-threshold-"></a></dt>
<dd><p>The second threshold for dividing the survival
probabilities (default is 0.99).</p></dd>


<dt id="arg-z">Z<a class="anchor" aria-label="anchor" href="#arg-z"></a></dt>
<dd><p>The Z value used for calculating confidence intervals (default is
1.96).</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A tibble containing bin-level statistics including:
  - `bin_number`: The bin to which each patient was assigned.
  - `TA_b`: Total alive in each bin (number of patients who survived).
  - `TD_b`: Total dead in each bin (number of patients who did not survive).
  - `N_b`: Total number of patients in each bin.
  - `EM_b`: Estimated mortality rate for each bin (TD_b / (TA_b + TD_b)).
  - `bin_start`: The lower bound of the survival probability range for each bin.
  - `bin_end`: The upper bound of the survival probability range for each bin.
  - `midpoint`: The midpoint of the bin range (calculated as (bin_start + bin_end) / 2).
  - `R_b`: The width of each bin (bin_end - bin_start).
  - `AntiM_b`: The anticipated mortality for each bin, based on the midpoint.
  - `E_b`: The error bound for the RMM estimate, calculated using the bin size
  and anticipated mortality.
  - `numerator`: The weighted numerator for the RMM calculation.
  - `denominator`: The weighted denominator for the RMM calculation.
  - `RMM`: The Relative Mortality Metric (RMM) for each bin,
  quantifying the difference between observed and expected mortality.
  - `RMM_UL`: The upper 95<!-- % confidence limit for RMM. -->
  - `RMM_LL`: The lower 95<!-- % confidence limit for RMM. --></p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The Relative Mortality Metric (RMM) quantifies the performance of a center in
comparison to the anticipated mortality based on the TRISS national
benchmark. The RMM measures the difference between observed and expected
mortality, with a range from -1 to 1.</p>
<p>- An RMM of 0 indicates that the observed mortality aligns with the expected
national benchmark across all acuity levels.
- An RMM greater than 0 indicates better-than-expected performance, where
the center is outperforming the national benchmark.
- An RMM less than 0 indicates under-performance, where the center’s observed
mortality is higher than the expected benchmark.</p>
<p>This metric helps assess how a center's mortality compares to the national
standards, guiding quality improvement efforts.</p>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Nicolas Foss, Ed.D, MS, original paper and code in MATLAB by Nicholas
  J. Napoli, Ph.D., MS</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># Generate example data with high negative skewness set.seed(123)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Parameters</span></span></span>
<span class="r-in"><span><span class="va">n_patients</span> <span class="op">&lt;-</span> <span class="fl">10000</span>  <span class="co"># Total number of patients</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Generate survival probabilities (Ps) using a logistic distribution</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span>  <span class="co"># For reproducibility</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">Ps</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Logistic.html" class="external-link">plogis</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">n_patients</span>, mean <span class="op">=</span> <span class="fl">2</span>,</span></span>
<span class="r-in"><span>                    sd <span class="op">=</span> <span class="fl">1.5</span><span class="op">)</span></span></span>
<span class="r-in"><span>                    <span class="op">)</span>  <span class="co"># Skewed towards higher values</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Simulate survival outcomes based on Ps</span></span></span>
<span class="r-in"><span><span class="va">survival_outcomes</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html" class="external-link">rbinom</a></span><span class="op">(</span><span class="va">n_patients</span>,</span></span>
<span class="r-in"><span>                            size <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>                            prob <span class="op">=</span> <span class="va">Ps</span></span></span>
<span class="r-in"><span>                            <span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Create data frame</span></span></span>
<span class="r-in"><span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>Ps <span class="op">=</span> <span class="va">Ps</span>, survival <span class="op">=</span> <span class="va">survival_outcomes</span><span class="op">)</span> <span class="op">|&gt;</span></span></span>
<span class="r-in"><span><span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>death <span class="op">=</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/if_else.html" class="external-link">if_else</a></span><span class="op">(</span><span class="va">survival</span> <span class="op">==</span> <span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Example usage of the `rm_bin_summary` function</span></span></span>
<span class="r-in"><span><span class="fu">rm_bin_summary</span><span class="op">(</span>data <span class="op">=</span> <span class="va">data</span>, Ps_col <span class="op">=</span> <span class="va">Ps</span>,</span></span>
<span class="r-in"><span>               outcome_col <span class="op">=</span> <span class="va">survival</span></span></span>
<span class="r-in"><span>               <span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BB00;">✔</span> Data validation passed.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    bin_number TA_b TD_b  N_b       EM_b  bin_start   bin_end  midpoint</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1           1  454  657 1111 0.59135914 0.02257717 0.5423470 0.2824621</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2           2  686  425 1111 0.38253825 0.54234698 0.7015426 0.6219448</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3           3  850  261 1111 0.23492349 0.70154257 0.7958116 0.7486771</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4           4  922  189 1111 0.17011701 0.79581165 0.8571453 0.8264785</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5           5  971  139 1110 0.12522523 0.85714527 0.9000576 0.8786014</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6           6  727   78  805 0.09689441 0.90005763 0.9251891 0.9126234</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7           7  752   53  805 0.06583851 0.92518915 0.9460383 0.9356137</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8           8  779   26  805 0.03229814 0.94603830 0.9626674 0.9543529</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9           9  783   22  805 0.02732919 0.96266743 0.9762396 0.9694535</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10         10 1213   13 1226 0.01060359 0.97623957 0.9995787 0.9879091</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           R_b    AntiM_b         E_b     numerator  denominator       RMM_LL</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1  0.51976981 0.71753793 0.026472901  6.558393e-02 0.3729545526  0.149376746</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2  0.15919559 0.37805523 0.028513634 -7.136780e-04 0.0601847250 -0.040371760</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3  0.09426908 0.25132289 0.025507174  1.545956e-03 0.0236919780  0.039745137</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4  0.06133362 0.17352154 0.022268528  2.088121e-04 0.0106427043 -0.002648313</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5  0.04291236 0.12139855 0.019213093 -1.642116e-04 0.0052094984 -0.050734668</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6  0.02513152 0.08737661 0.019507496 -2.391967e-04 0.0021959070 -0.128435935</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7  0.02084916 0.06438627 0.016955206 -3.027788e-05 0.0013423995 -0.039510248</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8  0.01662913 0.04564713 0.014418476  2.219822e-04 0.0007590721  0.278020373</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9  0.01357214 0.03054650 0.011887823  4.366569e-05 0.0004145813  0.093436964</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10 0.02333909 0.01209088 0.006117843  3.471206e-05 0.0002821901  0.116891645</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            RMM       RMM_UL</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1   0.17584965  0.202322549</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2  -0.01185813  0.016655509</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3   0.06525231  0.090759485</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4   0.01962021  0.041888743</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5  -0.03152157 -0.012308481</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6  -0.10892844 -0.089420943</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7  -0.02255504 -0.005599836</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8   0.29243885  0.306857325</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9   0.10532479  0.117212609</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10  0.12300949  0.129127331</span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Nicolas Foss.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

